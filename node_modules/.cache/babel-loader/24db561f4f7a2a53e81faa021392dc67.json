{"ast":null,"code":"var _jsxFileName = \"/home/dhakad/Documents/AI/FF/Frontend_Test/src/views/examples/test_zoom_child.js\";\nimport React, { useRef, useEffect, useState } from \"react\";\nimport { select, line, curveCardinal, scaleLinear, axisBottom, axisRight, scaleBand, values, utcYears, scaleTime, extent, axisLeft, brushX, event, invert, zoom, zoomTransform, axisTop } from \"d3\";\nimport usePrevious from \"./usePrevious\";\nimport * as d3 from \"d3\";\n\nfunction Test_Zoom_Child(props) {\n  const data = props.data;\n  const svg = select(\".sup2\"); //const svgContent = svg.select(\".content\")\n\n  const [currentZoomState, setCurrentZoomState] = useState();\n  useEffect(() => {\n    var legend = svg.append('g').attr('class', 'chart__legend').attr('width', props.width).attr('height', 30).attr('transform', 'translate(50, 20)');\n    legend.append('text').attr('class', 'chart__symbol').text('AI DATABASES');\n    var rangeSelection = legend.append('g').attr('class', 'chart__range-selection').attr('transform', 'translate(110, 0)');\n    var dateRange = ['1w', '1m', '3m', '6m', '1y', '5y'];\n\n    for (var i = 0, l = dateRange.length; i < l; i++) {\n      var v = dateRange[i];\n      rangeSelection.append('text').attr('class', 'chart__range-selection').text(v).attr('transform', 'translate(' + 30 * i + ', 0)').on('click', function (d) {\n        console.log(\"clic\", d);\n      });\n    }\n\n    const yextent = extent(data, d => d.value);\n    const xextent = extent(data, d => d.year);\n    console.log(\"myselection\", props.selection[0], props.selection[1]); //[new Date(Math.floor(props.selection[0]),0,0),new Date(Math.ceil(props.selection[1]),0,0)]\n\n    var xscale = scaleTime().domain(props.selection).range([0, props.width]);\n    var yscale = scaleLinear().domain(yextent).range([props.height, 0]);\n\n    if (currentZoomState) {\n      const newxscale = currentZoomState.rescaleX(xscale);\n      xscale.domain(newxscale.domain());\n    }\n\n    svg.style(\"border\", \"1px solid gray\"); // svg.append(\"g\")\n    //   .attr(\"transform\", \"translate(0,\" + height + \")\")\n    //   .call(d3.axisBottom(x));\n\n    const xaxis = axisTop(xscale).ticks(data.length);\n    svg.select(\".x-axis\").attr(\"transform\", \"translate(0,\" + 281 + \")\").call(d3.axisBottom(xscale)); //  .style(\"transform\", `translateY(282px)`)\n    //  .\n\n    const yaxis = axisLeft(yscale);\n    svg.select(\".y-axis\").style(\"transform\", `translateX(25px)`).call(yaxis);\n    const myLine = line().x(d => xscale(new Date(Math.floor(d.year), 0, 0))).y(d => props.height - yscale(d.value)).curve(curveCardinal);\n    svg.selectAll(\"path\").data([data]).join(\"path\").style(\"transform\", \"scale(1, -1)\").attr(\"d\", myLine).attr(\"fill\", \"none\").attr(\"stroke\", \"blue\");\n    svg.selectAll(\".myDot\").data(data).join(\"circle\").attr(\"class\", \"myDot\").attr(\"stroke\", \"blue\").attr(\"r\", \"4\").attr(\"fill\", \"yellow\").attr(\"cx\", d => xscale(new Date(Math.floor(d.year), 0, 0))).attr(\"cy\", d => yscale(d.value) - 18).on(\"mouseover\", d => {\n      console.log(\"enteredd\");\n    }).on(\"mouseout\", function () {\n      console.log(\"leftt\");\n    }).transition().attr(\"height\", d => props.height - yscale(d.value));\n    svg.selectAll(\".helptext\").remove();\n    var x = svg.append(\"text\").attr(\"x\", props.width - 290).attr(\"y\", 35).attr(\"class\", \"helptext\");\n    svg.selectAll(\".Vtext\").remove();\n    var VT = svg.append(\"text\").attr(\"x\", 100).attr(\"y\", props.length).attr(\"class\", \"Vtext\").text(\"hiii\");\n    svg.on(\"mousemove\", function (d) {\n      var mouse = d3.mouse(this);\n      svg.selectAll(\".vline\").remove();\n      var date = xscale.invert(mouse[0]);\n      var val = yscale.invert(mouse[1]).toString().slice(0, 6);\n      var yr = date.toString().slice(0, 24); //console.log(yr);\n\n      var bisectDate = d3.bisector(function (d) {\n        ;\n        return new Date(d.year, 0, 0);\n      }).left;\n      var x0 = xscale.invert(d3.mouse(this)[0]);\n      var i = bisectDate(data, x0, 1);\n      var d0 = data[i - 1];\n      var d1 = data[i];\n      var d = x0 - new Date(d0.year, 0, 0) > new Date(d1.year, 0, 0) - x0 ? d1 : d0;\n      svg.selectAll(\".hline\").remove();\n      svg.append(\"line\").attr(\"class\", \"hline\").attr(\"x1\", 0).attr(\"y1\", yscale(d.value) - 18).attr(\"x2\", props.width).attr(\"y2\", yscale(d.value) - 18).attr(\"stroke\", \"black\").style(\"stroke-dasharray\", \"5, 6\").attr(\"stroke-width\", 0.8);\n      x.text(yr + \" : \" + val);\n      var lineyr = new Date(d.year, 0, 0).toString().slice(0, 15);\n      VT.attr(\"x\", d3.mouse(this)[0]).text(lineyr + \": \" + d.value);\n      svg.append(\"line\").attr(\"class\", \"crosshair\").attr(\"class\", \"vline\").attr(\"x1\", mouse[0]).attr(\"y1\", 0).attr(\"x2\", mouse[0]).attr(\"y2\", props.height).style(\"stroke-dasharray\", \"5, 6\").attr(\"stroke-width\", 0.8).attr(\"stroke\", \"black\");\n    });\n    svg.append(\"line\").attr(\"x1\", 0).attr(\"y1\", 282).attr(\"x2\", props.width).attr(\"y2\", 282).attr(\"stroke-width\", 0.7).attr(\"stroke\", \"black\");\n    svg.append(\"line\").attr(\"y1\", 0).attr(\"x1\", 27).attr(\"y2\", props.width).attr(\"x2\", 27).attr(\"stroke-width\", 0.7).attr(\"stroke\", \"black\");\n    const zoomBehavior = zoom().scaleExtent([1, 10]).translateExtent([[0, 0], [props.width, props.height]]).on(\"zoom\", () => {\n      const zoomState = d3.event.transform;\n      console.log(\"Current Zoom State\", zoomState);\n      setCurrentZoomState(zoomState);\n    });\n    svg.call(zoomBehavior);\n  }, [data, props.selection, currentZoomState]);\n\n  if (!props.selection) {\n    console.log(\"inititalll\");\n    return null;\n  }\n\n  return /*#__PURE__*/React.createElement(React.Fragment, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 207,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(\"svg\", {\n    className: \"sup2\",\n    width: props.width,\n    height: props.height,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 208,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(\"defs\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 209,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(\"clipPath\", {\n    id: \"myClipPath\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 210,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"rect\", {\n    x: \"0\",\n    y: \"0\",\n    width: \"100%\",\n    height: \"100%\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 211,\n      columnNumber: 15\n    }\n  }))), /*#__PURE__*/React.createElement(\"g\", {\n    className: \"content\",\n    clipPath: \"url(#myClipPath)\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 214,\n      columnNumber: 11\n    }\n  }), /*#__PURE__*/React.createElement(\"g\", {\n    className: \"x-axis\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 215,\n      columnNumber: 11\n    }\n  }), /*#__PURE__*/React.createElement(\"g\", {\n    className: \"y-axis\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 216,\n      columnNumber: 11\n    }\n  }), /*#__PURE__*/React.createElement(\"g\", {\n    className: \"brush\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 217,\n      columnNumber: 11\n    }\n  })));\n}\n\nexport default Test_Zoom_Child;","map":{"version":3,"sources":["/home/dhakad/Documents/AI/FF/Frontend_Test/src/views/examples/test_zoom_child.js"],"names":["React","useRef","useEffect","useState","select","line","curveCardinal","scaleLinear","axisBottom","axisRight","scaleBand","values","utcYears","scaleTime","extent","axisLeft","brushX","event","invert","zoom","zoomTransform","axisTop","usePrevious","d3","Test_Zoom_Child","props","data","svg","currentZoomState","setCurrentZoomState","legend","append","attr","width","text","rangeSelection","dateRange","i","l","length","v","on","d","console","log","yextent","value","xextent","year","selection","xscale","domain","range","yscale","height","newxscale","rescaleX","style","xaxis","ticks","call","yaxis","myLine","x","Date","Math","floor","y","curve","selectAll","join","transition","remove","VT","mouse","date","val","toString","slice","yr","bisectDate","bisector","left","x0","d0","d1","lineyr","zoomBehavior","scaleExtent","translateExtent","zoomState","transform"],"mappings":"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","sourcesContent":["import React, { useRef, useEffect, useState } from \"react\";\nimport { select , line, curveCardinal, scaleLinear, axisBottom, axisRight, scaleBand, values, utcYears, scaleTime, extent, axisLeft, brushX, event, invert, zoom, zoomTransform, axisTop } from \"d3\";\nimport usePrevious from \"./usePrevious\";\nimport * as d3 from \"d3\"\n\nfunction Test_Zoom_Child(props) {\n  const data = props.data;\n  const svg = select(\".sup2\");\n  //const svgContent = svg.select(\".content\")\n  const [currentZoomState, setCurrentZoomState] = useState();\n  \n  useEffect(() => {\n\n\n\n    var legend = svg.append('g')\n    .attr('class', 'chart__legend')\n    .attr('width', props.width)\n    .attr('height', 30)\n    .attr('transform', 'translate(50, 20)');\n\n  legend.append('text')\n    .attr('class', 'chart__symbol')\n    .text('AI DATABASES')\n\n  var rangeSelection =  legend\n    .append('g')\n    .attr('class', 'chart__range-selection')\n    .attr('transform', 'translate(110, 0)');\n\n    var dateRange = ['1w', '1m', '3m', '6m', '1y', '5y']\n    for (var i = 0, l = dateRange.length; i < l; i ++) {\n      var v = dateRange[i];\n      rangeSelection\n        .append('text')\n        .attr('class', 'chart__range-selection')\n        .text(v)\n        .attr('transform', 'translate(' + (30 * i) + ', 0)')\n        .on('click', function(d) { console.log(\"clic\",d)  });\n    }\n\n\n   const yextent = extent(data, d=>d.value)\n   const xextent = extent(data, d=>d.year)\n   console.log(\"myselection\",props.selection[0],props.selection[1])\n//[new Date(Math.floor(props.selection[0]),0,0),new Date(Math.ceil(props.selection[1]),0,0)]\n    var xscale =scaleTime().domain(props.selection).range([0, props.width])\n   var yscale =scaleLinear().domain(yextent).range([props.height,0])\n\n  \n\n   if (currentZoomState) {\n    const newxscale = currentZoomState.rescaleX(xscale);\n    xscale.domain(newxscale.domain())\n  }\n  \t\n\n\tsvg.style(\"border\",\"1px solid gray\")\n\n\n// svg.append(\"g\")\n//   .attr(\"transform\", \"translate(0,\" + height + \")\")\n//   .call(d3.axisBottom(x));\n   const xaxis = axisTop(xscale).ticks(data.length)\n   svg\n   .select(\".x-axis\")\n   .attr(\"transform\", \"translate(0,\" + 281 + \")\")\n   .call(d3.axisBottom(xscale))\n\n\n  //  .style(\"transform\", `translateY(282px)`)\n  //  .\n   const yaxis = axisLeft(yscale);\n   svg\n   .select(\".y-axis\")\n   .style(\"transform\", `translateX(25px)`)\n   .call(yaxis)\n\n  \n    const myLine = line()\n      .x(d => xscale(new Date(Math.floor(d.year),0,0)))\n      .y(d => props.height - yscale(d.value))\n    .curve(curveCardinal);\n      \n    svg\n      .selectAll(\"path\")\n      .data([data])\n      .join(\"path\")\n      .style(\"transform\", \"scale(1, -1)\")\n      .attr(\"d\", myLine)\n      .attr(\"fill\", \"none\")\n      .attr(\"stroke\", \"blue\")\n      \n\n      svg\n      .selectAll(\".myDot\")\n      .data(data)\n      .join(\"circle\")\n      .attr(\"class\", \"myDot\")\n      .attr(\"stroke\", \"blue\")\n      .attr(\"r\", \"4\")\n      .attr(\"fill\", \"yellow\")\n      .attr(\"cx\", (d) => xscale(new Date(Math.floor(d.year),0,0)))\n      .attr(\"cy\", (d) => yscale(d.value) - 18)\n      .on(\"mouseover\", (d) => {\tconsole.log(\"enteredd\")})\n      .on(\"mouseout\",function(){console.log(\"leftt\")})\n      .transition()\n      .attr(\"height\", d => props.height - yscale(d.value))\n\n\n      svg.selectAll(\".helptext\").remove();\n      var x = svg.append(\"text\")\n.attr(\"x\", props.width - 290)\n.attr(\"y\", 35)\n.attr(\"class\",\"helptext\");\n\nsvg.selectAll(\".Vtext\").remove();\nvar VT = svg.append(\"text\")\n.attr(\"x\", 100)\n.attr(\"y\", props.length)\n.attr(\"class\",\"Vtext\")\n.text(\"hiii\");\n\n\t\n\tsvg.on(\"mousemove\",function(d){\n\t\n\tvar mouse = d3.mouse(this);\n\tsvg.selectAll(\".vline\").remove()\n\t\n\tvar date = xscale.invert(mouse[0])\n\tvar val = yscale.invert(mouse[1]).toString().slice(0,6)\n\tvar yr = date.toString().slice(0,24);\n\t\n\t//console.log(yr);\n\n\t  var bisectDate = d3.bisector(function(d) { ; return new Date(d.year,0,0); }).left\n \tvar x0 = xscale.invert(d3.mouse(this)[0]);\n\t\n        var i = bisectDate(data, x0, 1);\n\t\n        var d0 = data[i - 1];\n        var d1 = data[i];\n        var d = x0 - new Date(d0.year,0,0)> new Date(d1.year,0,0) - x0 ? d1 : d0;\n\n\t\n\tsvg.selectAll(\".hline\").remove()\n  \n\t\n\n        svg.append(\"line\")\n\t.attr(\"class\",\"hline\")\n\t.attr(\"x1\",0)\n\t.attr(\"y1\",yscale(d.value) - 18)\n\t.attr(\"x2\",props.width)\n\t.attr(\"y2\",yscale(d.value) - 18)\n  .attr(\"stroke\",\"black\")\n  .style(\"stroke-dasharray\", (\"5, 6\")) \n\t.attr(\"stroke-width\",0.8)\n\t\n\tx.text(yr+\" : \"+val)\n\t\n\tvar lineyr = new Date(d.year,0,0).toString().slice(0,15);\n\t\n\tVT.attr(\"x\",d3.mouse(this)[0]).text(lineyr+\": \"+d.value);\n  \n  svg\n\t.append(\"line\")\n\t.attr(\"class\",\"crosshair\")\n\t.attr(\"class\",\"vline\")\n\t.attr(\"x1\",mouse[0])\n\t.attr(\"y1\",0)\n\t.attr(\"x2\",mouse[0])\n  .attr(\"y2\",props.height)\n  .style(\"stroke-dasharray\", (\"5, 6\")) \n\t.attr(\"stroke-width\",0.8)\n\t.attr(\"stroke\",\"black\")\t\n})\n\nsvg.append(\"line\").attr(\"x1\",0).attr(\"y1\",282).attr(\"x2\",props.width).attr(\"y2\",282).attr(\"stroke-width\",0.7).attr(\"stroke\",\"black\")\nsvg.append(\"line\").attr(\"y1\",0).attr(\"x1\",27).attr(\"y2\",props.width).attr(\"x2\",27).attr(\"stroke-width\",0.7).attr(\"stroke\",\"black\")\n\n   \n      const zoomBehavior = zoom()\n      .scaleExtent([1, 10])\n      .translateExtent([\n        [0, 0],\n        [props.width, props.height]\n      ])\n      .on(\"zoom\", () => {\n        \n        const zoomState = d3.event.transform;\n        console.log(\"Current Zoom State\", zoomState)\n        setCurrentZoomState(zoomState);\n        \n      });\n      \n    svg.call(zoomBehavior)\n      \n  }, [data, props.selection, currentZoomState]);\n\n  if (!props.selection) {\n    console.log(\"inititalll\")\n    return null;\n  }\n\n  return (\n      <React.Fragment>\n    <svg className=\"sup2\" width={props.width} height={props.height}>\n    <defs>\n            <clipPath id=\"myClipPath\">\n              <rect x=\"0\" y=\"0\" width=\"100%\" height=\"100%\" />\n            </clipPath>\n          </defs>\n          <g className=\"content\" clipPath=\"url(#myClipPath)\"></g>\n          <g className = \"x-axis\"></g>\n          <g className = \"y-axis\"></g>\n          <g className = \"brush\"></g>\n        </svg>\n       </React.Fragment>\n  );\n\n}\n\nexport default Test_Zoom_Child;\n"]},"metadata":{},"sourceType":"module"}