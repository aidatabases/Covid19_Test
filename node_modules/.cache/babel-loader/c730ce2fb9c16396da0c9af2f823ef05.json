{"ast":null,"code":"var _jsxFileName = \"/Users/deadman/Session-Management/frontend/src/views/examples/Top.js\";\nimport React, { useState, useEffect } from 'react';\nimport axios from 'axios';\nimport { useParams, useLocation } from \"react-router\";\nimport \"./tt.css\";\n\nfunction Top({\n  country\n}) {\n  // const params = useParams()\n  // let country = params.country\n  // let mode = params.mode\n  const [import_list, setImportList] = useState([]);\n  const [export_list, setExportList] = useState([]);\n  const [loading, setloading] = useState(false);\n  const [error, seterror] = useState(false); // var url = 'http://159.65.150.184:9200/trade_analytica_march/_search'\n\n  var url = 'http://159.65.150.184:9200/hello_trade_analytica/_search';\n  let query = get_query(country); // let query = get_query2(country)\n\n  useEffect(() => {\n    setloading(true);\n    axios.post(url, query).then(d => {\n      if (d.status === 200) {\n        // let data = d.data.hits.hits._source.data\n        // let data = d.data.aggregations\n        let import_data = d.data.aggregations.import.import_data.buckets;\n        let export_data = d.data.aggregations.export.export_data.buckets;\n        console.log(\"import data ----- \", import_data);\n        console.log(\"export data ----- \", export_data);\n        let list = get_list_from_buckets(import_data);\n        let list2 = get_list_from_buckets(export_data);\n        setImportList(list);\n        setExportList(list2);\n        console.log(\"list ---\", list, \"\\nlist ----2\", list2);\n      } else {\n        console.log(\"err\");\n      }\n\n      setloading(false);\n    }).catch(error => {\n      console.log(error);\n      setloading(false);\n      seterror(true);\n    });\n\n    if (loading) {\n      seterror(true);\n    }\n  }, []);\n  if (loading) return /*#__PURE__*/React.createElement(\"p\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 69,\n      columnNumber: 25\n    }\n  }, \"Loading...\");\n  if (error) return /*#__PURE__*/React.createElement(\"p\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 70,\n      columnNumber: 23\n    }\n  }, \"Error!\");\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: \"top-all-tab-con\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 73,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"top-imp-tab-con\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 77,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"h3\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 78,\n      columnNumber: 13\n    }\n  }, \"Import Commodities in \", country), /*#__PURE__*/React.createElement(\"table\", {\n    id: \"tt-tab\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 80,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"tr\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 81,\n      columnNumber: 15\n    }\n  }, /*#__PURE__*/React.createElement(\"th\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 82,\n      columnNumber: 17\n    }\n  }, \"hscode\"), /*#__PURE__*/React.createElement(\"th\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 83,\n      columnNumber: 17\n    }\n  }, \"Value - 2018\")), import_list.map(element => {\n    return /*#__PURE__*/React.createElement(\"tr\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 88,\n        columnNumber: 19\n      }\n    }, /*#__PURE__*/React.createElement(\"td\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 89,\n        columnNumber: 21\n      }\n    }, element.hs_code), /*#__PURE__*/React.createElement(\"td\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 90,\n        columnNumber: 21\n      }\n    }, element.value));\n  }))), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"top-exp-tab-con\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 97,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"h3\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 98,\n      columnNumber: 13\n    }\n  }, \"Export Commodities in \", country), /*#__PURE__*/React.createElement(\"table\", {\n    id: \"tt-tab\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 99,\n      columnNumber: 14\n    }\n  }, /*#__PURE__*/React.createElement(\"tr\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 100,\n      columnNumber: 15\n    }\n  }, /*#__PURE__*/React.createElement(\"th\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 101,\n      columnNumber: 17\n    }\n  }, \"hscode\"), /*#__PURE__*/React.createElement(\"th\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 102,\n      columnNumber: 17\n    }\n  }, \"Value - 2018\")), export_list.map(element => {\n    return /*#__PURE__*/React.createElement(\"tr\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 107,\n        columnNumber: 19\n      }\n    }, /*#__PURE__*/React.createElement(\"td\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 108,\n        columnNumber: 21\n      }\n    }, element.hs_code), /*#__PURE__*/React.createElement(\"td\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 109,\n        columnNumber: 21\n      }\n    }, element.value));\n  }))), /*#__PURE__*/React.createElement(\"br\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 117,\n      columnNumber: 13\n    }\n  }), /*#__PURE__*/React.createElement(\"br\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 118,\n      columnNumber: 13\n    }\n  }), /*#__PURE__*/React.createElement(\"br\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 119,\n      columnNumber: 13\n    }\n  }), /*#__PURE__*/React.createElement(\"br\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 120,\n      columnNumber: 13\n    }\n  }), /*#__PURE__*/React.createElement(\"br\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 126,\n      columnNumber: 13\n    }\n  }), /*#__PURE__*/React.createElement(\"br\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 127,\n      columnNumber: 13\n    }\n  }), /*#__PURE__*/React.createElement(\"br\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 128,\n      columnNumber: 13\n    }\n  }), /*#__PURE__*/React.createElement(\"br\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 129,\n      columnNumber: 13\n    }\n  }));\n}\n\nfunction get_list_from_buckets(bucket) {\n  let list_bucket = bucket.map(item => {\n    let value = item.key;\n    let data = item.details.hits.hits[0]._source;\n    let hscode = data.HSCode;\n    return {\n      hs_code: hscode,\n      value: value\n    };\n  });\n  return list_bucket;\n}\n\nfunction get_query(country) {\n  let query = {\n    \"query\": {\n      \"bool\": {\n        \"must\": [{\n          \"match\": {\n            \"Country\": country\n          }\n        }]\n      }\n    },\n    \"aggs\": {\n      \"import\": {\n        \"filter\": {\n          \"term\": {\n            \"Mode\": \"Import\"\n          }\n        },\n        \"aggs\": {\n          \"import_data\": {\n            \"terms\": {\n              \"field\": \"data.2018\",\n              \"order\": {\n                \"_key\": \"desc\"\n              }\n            },\n            \"aggs\": {\n              \"details\": {\n                \"top_hits\": {\n                  \"size\": 1,\n                  \"_source\": {\n                    \"includes\": [\"Country\", \"HSCode\", \"HSCodeName\"]\n                  }\n                }\n              }\n            }\n          }\n        }\n      },\n      \"export\": {\n        \"filter\": {\n          \"term\": {\n            \"Mode\": \"Export\"\n          }\n        },\n        \"aggs\": {\n          \"export_data\": {\n            \"terms\": {\n              \"field\": \"data.2018\",\n              \"order\": {\n                \"_key\": \"desc\"\n              }\n            },\n            \"aggs\": {\n              \"details\": {\n                \"top_hits\": {\n                  \"size\": 1,\n                  \"_source\": {\n                    \"includes\": [\"Country\", \"HSCode\", \"HSCodeName\"]\n                  }\n                }\n              }\n            }\n          }\n        }\n      }\n    },\n    \"size\": 0\n  };\n  return query;\n}\n\nfunction get_query2(country) {\n  let query = {\n    \"query\": {\n      \"bool\": {\n        \"must\": [{\n          \"match\": {\n            \"Country\": country\n          }\n        }]\n      }\n    },\n    \"aggs\": {\n      \"import\": {\n        \"filter\": {\n          \"term\": {\n            \"Mode.keyword\": \"Import\"\n          }\n        },\n        \"aggs\": {\n          \"import_data\": {\n            \"terms\": {\n              \"field\": \"data.2018.keyword\",\n              \"order\": {\n                \"_key\": \"desc\"\n              }\n            },\n            \"aggs\": {\n              \"details\": {\n                \"top_hits\": {\n                  \"size\": 1,\n                  \"_source\": {\n                    \"includes\": [\"Country\", \"HSCode\", \"HSCodeName\"]\n                  }\n                }\n              }\n            }\n          }\n        }\n      },\n      \"export\": {\n        \"filter\": {\n          \"term\": {\n            \"Mode.keyword\": \"Export\"\n          }\n        },\n        \"aggs\": {\n          \"export_data\": {\n            \"terms\": {\n              \"field\": \"data.2018.keyword\",\n              \"order\": {\n                \"_key\": \"desc\"\n              }\n            },\n            \"aggs\": {\n              \"details\": {\n                \"top_hits\": {\n                  \"size\": 1,\n                  \"_source\": {\n                    \"includes\": [\"Country\", \"HSCode\", \"HSCodeName\"]\n                  }\n                }\n              }\n            }\n          }\n        }\n      }\n    },\n    \"size\": 0\n  };\n  return query;\n}\n\nexport default Top;","map":{"version":3,"sources":["/Users/deadman/Session-Management/frontend/src/views/examples/Top.js"],"names":["React","useState","useEffect","axios","useParams","useLocation","Top","country","import_list","setImportList","export_list","setExportList","loading","setloading","error","seterror","url","query","get_query","post","then","d","status","import_data","data","aggregations","import","buckets","export_data","export","console","log","list","get_list_from_buckets","list2","catch","map","element","hs_code","value","bucket","list_bucket","item","key","details","hits","_source","hscode","HSCode","get_query2"],"mappings":"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","sourcesContent":["import React, {useState, useEffect} from 'react'\nimport axios from 'axios'\nimport {useParams,useLocation} from \"react-router\";\nimport \"./tt.css\";\n\nfunction Top({country}){\n    // const params = useParams()\n    // let country = params.country\n    // let mode = params.mode\n\n    const [import_list,setImportList] = useState([])\n    const [export_list,setExportList] = useState([])\n    const [loading,setloading] = useState(false)\n    const [error,seterror] = useState(false)\n\n\n\n    // var url = 'http://159.65.150.184:9200/trade_analytica_march/_search'\n    var url = 'http://159.65.150.184:9200/hello_trade_analytica/_search'\n\n\n    let query = get_query(country)\n    // let query = get_query2(country)\n    \n\n\n\n\n    useEffect(() => {\n      setloading(true)\n      axios.post(url, query)\n        .then( d => {\n          if(d.status === 200 ){\n            // let data = d.data.hits.hits._source.data\n            // let data = d.data.aggregations\n            let import_data = d.data.aggregations.import.import_data.buckets\n            let export_data = d.data.aggregations.export.export_data.buckets\n\n\n            console.log(\"import data ----- \",import_data)\n            console.log(\"export data ----- \",export_data)\n            \n\n            let list = get_list_from_buckets(import_data)\n            let list2 = get_list_from_buckets(export_data)\n            setImportList(list)\n            setExportList(list2)\n            \n            console.log(\"list ---\",list,\"\\nlist ----2\",list2)\n          }\n          else{\n            console.log(\"err\")\n          }\n          setloading(false)\n        })\n        .catch( error => {\n            console.log(error)\n            setloading(false)\n            seterror(true)\n        });\n        if(loading){\n          seterror(true)\n        }\n\n    },[])\n\n\n\n    if (loading) return <p>Loading...</p>\n    if (error) return <p>Error!</p>\n\n    return (\n        <div className=\"top-all-tab-con\">\n            {/* <h2>{country}</h2> */}\n            \n\n            <div className=\"top-imp-tab-con\">\n            <h3>Import Commodities in {country}</h3>\n\n            <table id=\"tt-tab\">\n              <tr>\n                <th>hscode</th>\n                <th>Value - 2018</th>\n              </tr>\n              {\n              import_list.map(element => {\n                return (\n                  <tr>\n                    <td>{element.hs_code}</td>\n                    <td>{element.value}</td>\n                  </tr>\n                )\n              })\n              }\n            </table>\n            </div>\n            <div className=\"top-exp-tab-con\">\n            <h3>Export Commodities in {country}</h3>\n            {<table id=\"tt-tab\">\n              <tr>\n                <th>hscode</th>\n                <th>Value - 2018</th>\n              </tr>\n              {\n              export_list.map(element => {\n                return (\n                  <tr>\n                    <td>{element.hs_code}</td>\n                    <td>{element.value}</td>\n                  </tr>\n                )\n              })\n              }\n            </table>\n            }\n            </div>\n            <br />\n            <br />\n            <br />\n            <br />\n            {/* <h5>Import data</h5> */}\n            {/* <p>{JSON.stringify(import_list)}</p> */}\n\n            {/* <h5>Export data</h5> */}\n            {/* <p>{JSON.stringify(export_list)}</p> */}\n            <br />\n            <br />\n            <br />\n            <br />\n        </div>\n    )\n}\n\n\n\n\nfunction get_list_from_buckets(bucket){\n    let list_bucket = bucket.map(item => {\n        let value = item.key\n        let data = item.details.hits.hits[0]._source\n        let hscode = data.HSCode\n\n        return {hs_code:hscode,value : value}\n    })\n\n    return list_bucket\n}\n\nfunction get_query(country){\n    let query = {\n        \"query\": {\n          \"bool\": {\n            \"must\": [\n              {\"match\": {\"Country\": country}}\n            ]\n          }\n        },\n        \"aggs\": {\n          \"import\": {\n            \"filter\": {\n              \"term\": {\n              \"Mode\": \"Import\"\n            }\n          },\n          \"aggs\": {\n            \"import_data\": {\n              \"terms\": {\n                \"field\": \"data.2018\",\n                \"order\": {\n                  \"_key\": \"desc\"\n                }\n              },\n              \"aggs\": {\n                \"details\": {\"top_hits\": {\"size\": 1, \"_source\": {\"includes\": [\"Country\",\"HSCode\",\"HSCodeName\"]}}}\n                }\n              }\n            }\n          },\n          \"export\": {\n            \"filter\": {\n              \"term\": {\n              \"Mode\": \"Export\"\n            }\n          },\n          \"aggs\": {\n            \"export_data\": {\n              \"terms\": {\n                \"field\": \"data.2018\",\n                \"order\": {\n                  \"_key\": \"desc\"\n                }\n              },\n              \"aggs\": {\n                \"details\": {\"top_hits\": {\"size\": 1, \"_source\": {\"includes\": [\"Country\",\"HSCode\",\"HSCodeName\"]}}}\n                }\n              }\n            }\n          }\n        }\n        ,\n        \"size\": 0\n      }\n\n    return query\n}\n\n\nfunction get_query2(country){\n    let query = {\n        \"query\": {\n          \"bool\": {\n            \"must\": [\n              {\"match\": {\"Country\": country}}\n            ]\n          }\n        },\n        \"aggs\": {\n          \"import\": {\n            \"filter\": {\n              \"term\": {\n              \"Mode.keyword\": \"Import\"\n            }\n          },\n          \"aggs\": {\n            \"import_data\": {\n              \"terms\": {\n                \"field\": \"data.2018.keyword\",\n                \"order\": {\n                  \"_key\": \"desc\"\n                }\n              },\n              \"aggs\": {\n                \"details\": {\"top_hits\": {\"size\": 1, \"_source\": {\"includes\": [\"Country\",\"HSCode\",\"HSCodeName\"]}}}\n                }\n              }\n            }\n          },\n          \"export\": {\n            \"filter\": {\n              \"term\": {\n              \"Mode.keyword\": \"Export\"\n            }\n          },\n          \"aggs\": {\n            \"export_data\": {\n              \"terms\": {\n                \"field\": \"data.2018.keyword\",\n                \"order\": {\n                  \"_key\": \"desc\"\n                }\n              },\n              \"aggs\": {\n                \"details\": {\"top_hits\": {\"size\": 1, \"_source\": {\"includes\": [\"Country\",\"HSCode\",\"HSCodeName\"]}}}\n                }\n              }\n            }\n          }\n        },\n        \"size\": 0\n      }\n\n      return query\n}\n\n\n\n\nexport default Top"]},"metadata":{},"sourceType":"module"}