{"ast":null,"code":"var _jsxFileName = \"/Users/deadman/Session-Management/frontend/src/views/examples/Tab.js\";\nimport React, { useState, useEffect } from 'react';\nimport axios from 'axios'; // import { forceCenter } from 'd3'\n\nimport \"./Tab.css\";\nimport DatatablePage from './sun'; // import { makeStyles } from '@material-ui/core/styles';\n// import Paper from '@material-ui/core/Paper';\n// import Table from '@material-ui/core/Table';\n// import TableBody from '@material-ui/core/TableBody';\n// import TableCell from '@material-ui/core/TableCell';\n// import TableContainer from '@material-ui/core/TableContainer';\n// import TableHead from '@material-ui/core/TableHead';\n// import TablePagination from '@material-ui/core/TablePagination';\n// import TableRow from '@material-ui/core/TableRow';\n// import { Table } from 'semantic-ui-react'\n\nfunction Tab({\n  level3_key,\n  level2_key\n}) {\n  const url = 'http://159.65.150.184:9200/ai_economics_v1_1/_search';\n  const [temp, setData] = useState([]);\n  const [list, setlist] = useState([]);\n  useEffect(() => {\n    console.log(\"data ---\", level3_key);\n    var query = Qur(level3_key, level2_key);\n    axios.post(url, query).then(d => {\n      if (d.status === 200) {\n        let data = d.data.hits.hits;\n        var temp = {};\n\n        for (var x in data) {\n          let dataobject = data[x]._source;\n          let key = dataobject.Level4;\n\n          if (dataobject.Level5 !== null) {\n            let l = [dataobject.Level5, dataobject.data];\n            temp[key] = temp[key] || [];\n            temp[key].push(l);\n          }\n        } // console.log(\"data\",data)\n\n\n        let level4 = d.data.aggregations.level4_feilds.buckets;\n        console.log(level4);\n        let list = level4.map(s => {\n          return {\n            \"label\": s.key,\n            \"value\": s.key\n          };\n        }); //console.log(list,\"list\")\n\n        setlist(list);\n        setData(temp);\n      } else {\n        console.log(\"err\");\n      }\n    }).catch(error => {\n      if (error) {\n        console.log(error);\n      } else {\n        console.log(\"Error!\");\n      }\n    });\n  }, [level3_key]);\n\n  function Qur(lev3, lev2) {\n    let query = {\n      \"query\": {\n        \"bool\": {\n          \"must\": [{\n            \"match\": {\n              \"Level2.keyword\": lev2\n            }\n          }],\n          \"filter\": [{\n            \"term\": {\n              \"Level3.keyword\": lev3\n            }\n          }]\n        }\n      },\n      \"aggs\": {\n        \"level4_feilds\": {\n          \"terms\": {\n            \"field\": \"Level4.keyword\"\n          }\n        }\n      },\n      \"size\": 10000\n    };\n    return query;\n  }\n\n  const Tablecreate = k => {\n    var columns = [{\n      label: 'Year',\n      field: 'Year',\n      sort: 'dsc',\n      width: 150\n    }];\n    var cc = [];\n\n    for (let i in temp[k]) {\n      let xy = temp[k][i][0];\n      cc.push({\n        \"label\": xy,\n        \"field\": xy,\n        \"sort\": 'asc',\n        \"width\": 150\n      });\n    }\n\n    columns = columns.concat(cc);\n    let x;\n\n    for (let i in temp[k]) {\n      x = temp[k][i][1];\n      break;\n    }\n\n    let rows = [];\n\n    for (let i in x) {\n      let sup = {\n        \"Year\": parseInt(i)\n      };\n      let abc;\n      let p = [];\n      let q = [];\n\n      for (let j in temp[k]) {\n        let z = temp[k][j];\n        p.push(z[0]);\n        q.push(z[1][i]);\n      }\n\n      for (let j = 0; j < p.length; j++) {\n        sup[p[j]] = q[j];\n      }\n\n      rows.push(sup);\n    }\n\n    var tabledata = {\n      columns,\n      rows\n    };\n    return /*#__PURE__*/React.createElement(DatatablePage, {\n      data: tabledata,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 141,\n        columnNumber: 5\n      }\n    });\n  };\n\n  return /*#__PURE__*/React.createElement(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 145,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(\"h2\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 146,\n      columnNumber: 9\n    }\n  }, level3_key), /*#__PURE__*/React.createElement(\"ul\", {\n    style: {\n      listStyleType: \"none\"\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 147,\n      columnNumber: 7\n    }\n  }, list.map(item => /*#__PURE__*/React.createElement(\"li\", {\n    key: item.value,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 149,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"h3\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 150,\n      columnNumber: 11\n    }\n  }, item.value), Tablecreate(item.value)))));\n}\n\nexport default Tab;","map":{"version":3,"sources":["/Users/deadman/Session-Management/frontend/src/views/examples/Tab.js"],"names":["React","useState","useEffect","axios","DatatablePage","Tab","level3_key","level2_key","url","temp","setData","list","setlist","console","log","query","Qur","post","then","d","status","data","hits","x","dataobject","_source","key","Level4","Level5","l","push","level4","aggregations","level4_feilds","buckets","map","s","catch","error","lev3","lev2","Tablecreate","k","columns","label","field","sort","width","cc","i","xy","concat","rows","sup","parseInt","abc","p","q","j","z","length","tabledata","listStyleType","item","value"],"mappings":"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","sourcesContent":["import React, {useState, useEffect} from 'react'\nimport axios from 'axios'\n// import { forceCenter } from 'd3'\nimport \"./Tab.css\"\nimport DatatablePage from './sun'\n// import { makeStyles } from '@material-ui/core/styles';\n// import Paper from '@material-ui/core/Paper';\n// import Table from '@material-ui/core/Table';\n// import TableBody from '@material-ui/core/TableBody';\n// import TableCell from '@material-ui/core/TableCell';\n// import TableContainer from '@material-ui/core/TableContainer';\n// import TableHead from '@material-ui/core/TableHead';\n// import TablePagination from '@material-ui/core/TablePagination';\n// import TableRow from '@material-ui/core/TableRow';\n// import { Table } from 'semantic-ui-react'\n\n\nfunction Tab({level3_key,level2_key}){\n  const url = 'http://159.65.150.184:9200/ai_economics_v1_1/_search'\n  \n\n  const [temp, setData] = useState([])\n  const [list, setlist]=useState([])\n\n  useEffect(() => {\n    console.log(\"data ---\",level3_key)\n  var query = Qur(level3_key,level2_key)\n\n\n    axios.post(url, query)\n\t\t.then( d => {\n\t\t\tif(d.status === 200 ){\n\t\t\t\tlet data = d.data.hits.hits\n\t\t\t\tvar temp = {}\n\t\t\t\tfor(var x in data){\n\t\t\t\t\tlet dataobject = data[x]._source\n\t\t\t\t\tlet key = dataobject.Level4\n\t\t\t\t\tif( dataobject.Level5 !== null){\n\t\t\t\t\tlet l = [dataobject.Level5,dataobject.data]\n\t\t\t\t\ttemp[key] = temp[key] || [];\n          temp[key].push(l)\n          }\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\t// console.log(\"data\",data)\n        let level4 = d.data.aggregations.level4_feilds.buckets\n        console.log(level4)\n\t\t\t\tlet list = level4.map(s => {return {\"label\" : s.key ,\"value\" : s.key}})\n\t\t\t\t\n\t\t\t\t//console.log(list,\"list\")\n\t\t\t\tsetlist(list)\n        setData(temp)\n\t\t\t}\n\t\t\telse{\n\t\t\t\tconsole.log(\"err\")\n\t\t\t}\n\t\t})\n\t\t.catch( error => {\n\t\t\tif (error) {\n\t\t\t  console.log(error)\n\t\t\t}\n\t\t\telse{\n\t\t\t\tconsole.log(\"Error!\");\n\t\t\t}\n\t\t});\n  }, [level3_key])\n\n\n  function Qur(lev3,lev2){\n    let query = {\n      \"query\": {\n        \"bool\": {\n          \"must\": [\n            {\"match\": {\"Level2.keyword\":lev2}}\n          ],\n          \"filter\": [\n            {\"term\": {\"Level3.keyword\": lev3}}\n          ]\n          \n        }\n      },\n      \"aggs\": {\n        \"level4_feilds\": {\n          \"terms\": {\n            \"field\": \"Level4.keyword\"\n          }\n        }\n      },\n      \"size\":10000\n    }\n    return query;\n  }\n\n  \n\n  const Tablecreate = (k) => {\n    var columns= [\n      {\n        label: 'Year',\n        field: 'Year',\n        sort: 'dsc',\n        width: 150\n      }\n    ]\n    var cc=[]\n    for(let i in temp[k])\n    {\n     let xy=(temp[k][i][0]);\n     cc.push({\"label\":xy,\"field\":xy,\"sort\":'asc',\"width\":150})\n    }\n    columns=columns.concat(cc)\n    let x;\n    for(let i in temp[k])\n    {\n      x=(temp[k][i][1])\n      break;\n    }\n    let rows=[]\n    for(let i in x)\n    {\n      let sup={\"Year\":parseInt(i)}\n      let abc;\n      let p=[]\n      let q=[]\n      for(let j in temp[k])\n    {\n      let z=temp[k][j]\n      \n      p.push(z[0])\n      q.push(z[1][i])\n      \n    }\n    for (let j = 0; j < p.length; j++) {\n      sup[p[j]] = q[j];\n    }\n    rows.push(sup)\n    } \n    var tabledata = {columns,rows};\n    \n    return(\n    <DatatablePage data={tabledata}/>\n    )\n  }\n  return (\n    <div>\n        <h2>{level3_key}</h2>\n      <ul style={{listStyleType:\"none\"}}>\n        {list.map(item => (\n        <li key={item.value}>\n          <h3>{item.value}</h3>\n          {Tablecreate(item.value)}\n        </li>\n        ))}\n      </ul>\n    </div>\n        \n      \n  )\n\n\n}\nexport default Tab;\n"]},"metadata":{},"sourceType":"module"}